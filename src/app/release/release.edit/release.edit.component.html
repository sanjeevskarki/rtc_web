<div class="container" class="container mat-elevation-z9">
    <h1 mat-dialog-title></h1>
    <form [formGroup]="releaseForm" style="align-self: center;">

        <mat-form-field appearance="outline" style="width: 30rem;margin-right: 1rem;">
            <mat-label>Business Unit</mat-label>
            <mat-select formControlName="businessunit">
                <mat-option *ngFor="let businessunit of businessUnits" [value]="businessunit.value">
                    {{businessunit.viewValue}}
                </mat-option>
            </mat-select>
            <mat-error
                *ngIf="releaseForm.controls.businessunit.hasError('required') && releaseForm.controls.businessunit.touched">
                Business unit is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 30rem;margin-right: 1rem;">
            <mat-label>Product Name</mat-label>
            <input type="text" matInput formControlName="name">
            <mat-error *ngIf="releaseForm.controls.name.hasError('required') && releaseForm.controls.name.touched">
                Product Name is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 30rem;">
            <mat-label>Release Status</mat-label>
            <input type="text" matInput formControlName="status">
            <mat-error *ngIf="releaseForm.controls.status.hasError('required') && releaseForm.controls.status.touched">
                Status Unit is required
            </mat-error>
        </mat-form-field>
        <br>
        <mat-form-field appearance="outline" style="width: 23rem;margin-right: 1rem;">
            <mat-label>Release Date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date" (dateChange)="onChange($event)">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 6rem;margin-right: 1rem;">
            <mat-label>Work Week</mat-label>
            <input disabled="true" type="text" matInput value="{{(workWeek) ? (workWeek | workWeekPipe) : ''}}">

            <!-- <div *ngIf="isWorkWeekVisible">{{workWeek | workWeekPipe}}</div> -->
        </mat-form-field>


        <mat-form-field appearance="outline" style="width: 30rem;margin-right: 1rem;">
            <mat-label>Release Type</mat-label>
            <mat-select formControlName="type">
                <mat-option *ngFor="let release of releaseTypes" [value]="release.value">
                    {{release.viewValue}}
                </mat-option>
            </mat-select>
            <mat-error *ngIf="releaseForm.controls.type.hasError('required') && releaseForm.controls.type.touched">
                Release Type is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 15rem;margin-right: 1rem;">
            <mat-label>Select Milestone</mat-label>
            <mat-select formControlName="milestone">
                <mat-option *ngFor="let milestone of milestones" [value]="milestone.value">
                    {{milestone.viewValue}}
                </mat-option>
            </mat-select>
            <mat-error
                *ngIf="releaseForm.controls.milestone.hasError('required') && releaseForm.controls.milestone.touched">
                Milestone is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 12rem;">
            <mat-label>Data Collection Status</mat-label>
            <input type="text" matInput formControlName="status" value="{{dataCollectionStatus}}">

        </mat-form-field>
        <button mat-icon-button color="primary" matTooltip="Configure DataCollection"
            (click)="openDataCollectionDialog()">
            <mat-icon aria-label="Edit">edit</mat-icon>
        </button>
        <br>
        <mat-form-field appearance="outline" style="width: 22rem;margin-right: 1rem;">
            <mat-label>Qual Owner Name</mat-label>
            <input type="text" matInput formControlName="qualowner">
            <mat-error
                *ngIf="releaseForm.controls.qualowner.hasError('required') && releaseForm.controls.qualowner.touched">
                Owner is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 23rem;margin-right: 1rem;">
            <mat-label>Qual Owner Email</mat-label>
            <input type="text" matInput formControlName="qualowneremail">
            <mat-error
                *ngIf="releaseForm.controls.qualowneremail.hasError('required') && releaseForm.controls.qualowneremail.touched">
                Email is required
            </mat-error>
            <mat-error *ngIf="releaseForm.controls.qualowneremail.hasError('qualowneremail')">
                Please enter a valid email address
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 22rem;margin-right: 1rem;">
            <mat-label>Attorney Name</mat-label>
            <input type="text" matInput formControlName="attorneyname">
            <mat-error
                *ngIf="releaseForm.controls.attorneyname.hasError('required') && releaseForm.controls.attorneyname.touched">
                Attorney Name is required
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" style="width: 22rem;margin-right: 1rem;">
            <mat-label>Attorney Email</mat-label>
            <input type="text" matInput formControlName="attorneyemail">
            <mat-error
                *ngIf="releaseForm.controls.attorneyemail.hasError('required') && releaseForm.controls.attorneyemail.touched">
                Attorney Email is required
            </mat-error>
            <mat-error *ngIf="releaseForm.controls.attorneyemail.hasError('attorneyemail')">
                Please enter a valid email address
            </mat-error>
        </mat-form-field>
        <br>
        <mat-form-field appearance="outline" style="width: 92rem;">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description"></textarea>
            <mat-error
                *ngIf="releaseForm.controls.description.hasError('required') && releaseForm.controls.description.touched">
                Description is required
            </mat-error>
        </mat-form-field>
    </form>
    

    <div style="align-self: center;width: 92rem;margin-right: 1rem;">
        <!-- <button mat-flat-button matTooltip="Add Stakeholder" color="primary" (click)="addContact()">
                <mat-icon>add</mat-icon>Add Stakeholder
            </button> -->
        <button mat-flat-button matTooltip="Add Stakeholder" color="primary" (click)="openAddStakeholderDialog()"
            style="margin-bottom: 10px;">
            <mat-icon style="margin-bottom: 3px">add</mat-icon>Add Stakeholder
        </button>
        <div id="modalTarget" #targetModal *ngIf="stakeholders!.length > 0">
            <mat-table #stakeholdertable [dataSource]="stakeholders">
                <ng-container matColumnDef="name">
                    <mat-header-cell *matHeaderCellDef>Name</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{row.name}}</mat-cell>
                </ng-container>
                <ng-container matColumnDef="email">
                    <mat-header-cell *matHeaderCellDef>Email</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{row.email}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="wwid">
                    <mat-header-cell *matHeaderCellDef>WWID</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{row.wwid}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="role">
                    <mat-header-cell *matHeaderCellDef>Role</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{row.role}}</mat-cell>
                </ng-container>
                <ng-container matColumnDef="actions">
                    <mat-header-cell *matHeaderCellDef>
                    </mat-header-cell>

                    <mat-cell *matCellDef="let row; let i=index;">
                        <button mat-icon-button color="primary" matTooltip="Update Stakeholder"
                            (click)="updateStakeholder(row)">
                            <mat-icon aria-label="Edit">edit</mat-icon>
                        </button>
                        <button mat-icon-button color="primary" matTooltip="Delete Stakeholder"
                            (click)="deleteStakeholder(row)">
                            <mat-icon aria-label="Delete">delete_outline</mat-icon>
                        </button>
                    </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="stakeholderDisplayedColumns;sticky: true"
                    [style.background-color]="color">
                </mat-header-row>
                <mat-row *matRowDef="let row; columns: stakeholderDisplayedColumns;"></mat-row>
            </mat-table>
        </div>
    </div>
    <div style="width: 10%;margin-top: 10px; margin-bottom: 10px;margin-inline: auto;"></div>
    <button mat-flat-button matTooltip="Add/Update Release" color="primary"
        [disabled]="!releaseForm.valid || isReallyDifferent()" style="width: 10%;
                margin-top: 10px; margin-bottom: 10px;margin-inline: auto;" (click)="updateRelease()">Save</button>

</div>